<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to priorCON â€¢ priorCON</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to priorCON">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">priorCON</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="GitHub"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cadam00/priorCON/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to priorCON</h1>
                        <h4 data-toc-skip class="author">Christos Adam,
Nikolaos Nagkoulis, Aggeliki Doxa, Antonios D. Mazaris, Stelios
Katsanevakis</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/cadam00/priorCON/blob/main/vignettes/Introduction.Rmd" class="external-link"><code>vignettes/Introduction.Rmd</code></a></small>
      <div class="d-none name"><code>Introduction.Rmd</code></div>
    </div>

    
    
<p><strong>This research was conducted at the Department of Marine
Sciences, University of the Aegean, Greece, supported by the European
Unionâ€™s Horizon 2020 research and innovation programme
HORIZON-CL6â€“2021-BIODIV-01â€“12, under grant agreement No 101059407,
â€œMarinePlan â€“ Improved transdisciplinary science for effective
ecosystem-based maritime spatial planning and conservation in European
Seasâ€.</strong></p>
<div class="section level2">
<h2 id="introduction-to-the-priorcon-package-tutorial">
<strong>Introduction to the priorCON Package
(tutorial)</strong><a class="anchor" aria-label="anchor" href="#introduction-to-the-priorcon-package-tutorial"></a>
</h2>
<p>The <strong>priorCON</strong> package offers an innovative tool-set
that incorporates graph community detection methods into systematic
conservation planning. This package is designed to enhance spatial
prioritization by focusing on the protection of areas with high
ecological connectivity. Unlike traditional approaches that prioritize
individual planning units, <strong>priorCON</strong> focuses on clusters
of features that exhibit strong ecological linkages. The
<strong>priorCON</strong> package is built upon the
<strong>prioritizr</strong> package (<a href="#ref-prioritizr">Hanson et
al., 2024</a>; <a href="#ref-hanson2025">2025</a>), using commercial and
open-source exact algorithm solvers that ensure optimal solutions to
prioritization problems.</p>
<p><strong>Features of priorCON</strong></p>
<ul>
<li><p><strong>Graph Community Detection</strong>: The package utilizes
connectivity metrics to identify clusters of habitat patches with high
connectivity values.</p></li>
<li><p><strong>Spatial prioritization</strong>: The package uses the
connectivity metrics as inputs in prioritizr to identify areas with high
connectivity.</p></li>
<li><p><strong>Connectivity Estimation</strong>: The package estimates
the connectivity protection level by calculating the protected
connections.</p></li>
<li><p><strong>Post-processing</strong>: The package can be used to
produce and download the outputs of the analysis as shapefiles, matrices
and tmap plots.</p></li>
</ul>
<p>This workflow is shown on Fig. <a href="#ref-Figure1">1</a>.</p>
<img src="priorCON_flowchart.png" alt="Flow chart of the priorCON prioritization analysis. priorCON functions are indicated in grey boxes" width="100%"><p class="caption" align="center">
<span id="ref-Figure1"></span>Fig. 1: Flow chart of the <b>priorCON</b>
prioritization analysis. <b>priorCON</b> functions are indicated in grey
boxes
</p>
<p>This tutorial will guide you through the key functions of the
package, from data preparation to generating informative outputs to
address conservation connectivity challenges in diverse ecosystems.</p>
<div class="section level3">
<h3 id="workflow-running-the-analysis">
<strong>Workflow: Running the analysis</strong><a class="anchor" aria-label="anchor" href="#workflow-running-the-analysis"></a>
</h3>
<p>The package provides 4 steps to perform the analysis:</p>
<ol style="list-style-type: decimal">
<li><p>Preprocessing (Optional): Function
<code><a href="../reference/preprocess_graphs.html">preprocess_graphs()</a></code> is built in order to create edge lists
from various inputs formats.</p></li>
<li><p>Connectivity metrics estimation: Function
<code><a href="../reference/get_metrics.html">get_metrics()</a></code> is built to calculate the following graph
metrics: degree, eigenvector centrality, betweenness centrality, louvain
clustering, walktrap clustering, s-core, PageRank.</p></li>
<li><p>Prioritization: Functions <code><a href="../reference/basic_scenario.html">basic_scenario()</a></code> and
<code><a href="../reference/connectivity_scenario.html">connectivity_scenario()</a></code> are used to insert the data to
<strong>prioritizr</strong> run the prioritization problem and obtain
the optimum solutions.</p></li>
<li><p>Post-processing: Function <code><a href="../reference/get_outputs.html">get_outputs()</a></code> is used in
order to plot interactive maps and export tables, shapefiles and rasters
of the results</p></li>
</ol>
<p>The functions of steps 1 and 2 can be used within the spatial
conservation planning workflow as described here but also independently
to create and obtain the graph metrics that might be also useful within
other research contexts. In the next sections we provide an illustrative
example to explain in more detail how the functions operate.</p>
</div>
<div class="section level3">
<h3 id="installation">
<strong>Installation</strong><a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>All the functions of the package can be installed from CRAN in R
via</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"priorCON"</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, the package <strong>priorCON</strong> can be installed
at the development version from Github in R via</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://remotes.r-lib.org" class="external-link">remotes</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"cadam00/priorCON"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="illustration-example">
<strong>Illustration example</strong><a class="anchor" aria-label="anchor" href="#illustration-example"></a>
</h3>
<p>Let us consider the following dataset as an illustrative example. The
area examined is Thermaikos gulf in Greece. In this example, a
Lagrangian model has been run to the area, to estimate connectivity.
This connectivity will be incorporated into the analysis to obtain the
areas that need to be protected to maximize the connectivity protection.
Preprocessing is necessary in this case in order to transform the
Lagrangian data in an edge list.</p>
<div class="section level4">
<h4 id="step-1-preprocessing-optional">Step 1 Preprocessing (Optional):<a class="anchor" aria-label="anchor" href="#step-1-preprocessing-optional"></a>
</h4>
<p>The input of an edge list is required in most graph theoretic
approaches. Fig. <a href="#ref-Figure2">2</a> represents a typical
directed weighted graph. In the edge list, the first two columns utilize
the nodes IDs to represent edges and the last column corresponds to the
value of the edges. This value actually represents the connectivity
value between the corresponding nodes and may represent for instance
values resulting from particle drift models, migration probabilities or
other. This preprocessing step can be conducted using the function
<code><a href="../reference/preprocess_graphs.html">preprocess_graphs()</a></code> and serves in reading and transforming
the initial input data into an edge list. Further details on the initial
data formats are given below. In case that an edge list is available,
this step can be skipped.</p>
<p align="center">
<img src="priorCON_fig2.png" alt="Weighted directed graph (left): Circles represent nodes and arrows represent weighted edges. The tabular representation of the graph represents the edge list (right)." width="50%"></p>
<p class="caption" align="center">
<span id="ref-Figure2"></span>Fig. 2: Weighted directed graph (left):
Circles represent nodes and arrows represent weighted edges. The tabular
representation of the graph represents the edge list (right).
</p>
<p>Function <code><a href="../reference/preprocess_graphs.html">preprocess_graphs()</a></code> takes as input a list of
.txt/.csv objects. Each object represents the connections between a node
and all the other nodes. For the model to read the data, it is necessary
to have all the .txt/.csv objects in one folder. There are two ways to
incorporate connectivity data, based on their linkage to features:</p>
<ul>
<li><p>Case 1: the connectivity data correspond to specific biodiversity
features. If a biodiversity feature has its own connectivity dataset
then the file including the edge lists needs to have the same name as
the corresponding feature. For example, consider having 5 species (f1,
f2, f3, f4, f5) and 5 connectivity datasets. Then the connectivity
datasets need to be in separate folders named: f1,f2,f3,f4,f5 and the
algorithm will understand that they correspond to the species.</p></li>
<li><p>Case 2: the connectivity dataset represents a spatial pattern
that is not directly connected with a specific biodiversity feature.
Then the connectivity data need to be included in a separate folder
named in a different way than the species. For example consider having 5
species (f1,f2,f3,f4,f5) and 1 connectivity dataset. This dataset can be
included in a separate folder (e.g.Â â€œLangragian_conâ€).</p></li>
</ul>
<p>In our example we use connectivity values that are not directly
connected with a specific species, therefore we illustrate Case 2. Fig.
<a href="#ref-Figure3">3</a> represents the structure used in the
tutorial. The data need to be stored in this way in order for the
algorithm to read them properly.</p>
<p align="center">
<img src="priorCON_fig3.png" alt="Connectivity folder" width="50%"></p>
<p class="caption" align="center">
<span id="ref-Figure3"></span>Fig. 3: Connectivity folder
</p>
<p>A typical Lagrangian output is a set of files representing the
likelihood of a point moving from an origin (source) to a destination
(target). This can be represented using a list of .txt files (as many as
the origin points) including information for the destination
probability. The .txt files need to be named in an increasing order. The
name of the files need to correspond to the numbering of the points, in
order for the algorithm to match the coordinates with the points (Fig.
<a href="#ref-Figure4">4</a>).</p>
<p align="center">
<img src="priorCON_fig4.png" alt="The 001.txt file contains the following information: Each row represents the probability of movement between point 001 and any other destination points." width="50%"></p>
<p class="caption" align="center">
<span id="ref-Figure4"></span>Fig. 4: The 001.txt file contains the
following information: Each row represents the probability of movement
between point 001 and any other destination points.
</p>
<p>As long as the data are set in this way, the preprocessing algorithm
can run and transform the format of the inputs to an edge list. If an
edge list dataset is available, this preprocessing step can be
skipped.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Import packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cadam00/priorCON" class="external-link">priorCON</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-tmap/tmap" class="external-link">tmap</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## terra 1.8.54</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read connectivity files from folder and combine them</span></span>
<span>  <span class="va">combined_edge_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/preprocess_graphs.html">preprocess_graphs</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"external"</span>,package<span class="op">=</span><span class="st">"priorCON"</span><span class="op">)</span>,</span>
<span>    header <span class="op">=</span> <span class="cn">FALSE</span>, sep <span class="op">=</span><span class="st">";"</span></span>
<span>   <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="step-2-connectivity-metrics-estimation">Step 2 Connectivity Metrics Estimation:<a class="anchor" aria-label="anchor" href="#step-2-connectivity-metrics-estimation"></a>
</h4>
<p>Function <code><a href="../reference/get_metrics.html">get_metrics()</a></code> is used to calculate graph
metrics values. The edge lists created from the previous step, or
inserted directly from the user are used in this step to create graphs.
The directed graphs are transformed to undirected. The function is based
on the <strong>igraph</strong> package (<a href="#ref-csardi2006igraph">CsÃ¡rdi and Nepusz, 2006</a>; <a href="#ref-igraph">CsÃ¡rdi et al., 2024</a>) which is used to create
clusters using Louvain and Walktrap and calculate the following metrics:
Eigenvector Centrality, Betweenness Centrality, Degree and PageRank.
S-core is calculated using the package <strong>brainGraph</strong> (<a href="#ref-brainGraph">Watson, 2024</a>). The user can choose between
these options to create the respective outputs. <code>'s_core'</code>,
<code>'louvain'</code>, <code>'walktrap'</code>, <code>'eigen'</code>,
<code>'betw'</code>, <code>'deg'</code> or <code>'page_rank'</code>.</p>
<p>Detailed information on the theory and equations of the used graph
metrics are provided in Nagkoulis et al.(2024; subm Methods in Ecology
and Evolution).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Detect graph communities using the s-core algorithm</span></span>
<span><span class="va">pre_graphs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_metrics.html">get_metrics</a></span><span class="op">(</span><span class="va">combined_edge_list</span>, which_community <span class="op">=</span> <span class="st">"s_core"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="step-3-prioritization">Step 3 Prioritization:<a class="anchor" aria-label="anchor" href="#step-3-prioritization"></a>
</h4>
<p>Two alternative functions can be used for the prioritization step: i)
the <code><a href="../reference/connectivity_scenario.html">connectivity_scenario()</a></code> function, which includes
connectivity into the optimization procedure and ii) the
<code><a href="../reference/basic_scenario.html">basic_scenario()</a></code> function, which does not include
connectivity. The two functions can be run separately. Users may use
both functions, if they wish to compare the results obtained from the
two scenarios, i.e.Â with and without connectivity. Alternatively, only
the <code><a href="../reference/connectivity_scenario.html">connectivity_scenario()</a></code> function can be run to obtain
the prioritization outputs of the connectivity scenario. Both functions
are based on the <strong>priorititizr</strong> package (<a href="#ref-prioritizr">Hanson et al., 2024</a>; <a href="#ref-hanson2025">2025</a>). The connectivity metrics are first
transformed to rasters, following an approach similar to Marxan Connect
(<a href="#ref-daigle2020operationalizing">Daigle et al., 2020</a>).
Then <strong>priorititizr</strong> maximizes the utility obtained from
protecting both features and connections. Mathematically, the target of
the optimization is to maximize U under the budget (B) limitations (eq.
2 and 3 of Nagkoulis et al.Â (2024)):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mrow><mi>ğ</mi><msub><mi>ğ”</mi><mi>ğ¢</mi></msub></mrow><mspace width="0.167em"></mspace><mo>âˆˆ</mo><mspace width="0.167em"></mspace><mi>S</mi><mi>A</mi></mrow></munder><mo>âˆ’</mo><mi>Î»</mi><msub><mi>c</mi><mi>i</mi></msub><mo>+</mo><munder><mo>âˆ‘</mo><mrow><mrow><mi>ğ</mi><msub><mi>ğ”</mi><mi>ğ¢</mi></msub></mrow><mspace width="0.167em"></mspace><mo>âˆˆ</mo><mspace width="0.167em"></mspace><mi>S</mi><mi>A</mi></mrow></munder><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><msub><mi>Î¼</mi><mi>j</mi></msub><msub><mi>f</mi><mi>j</mi></msub><mo>+</mo><munder><mo>âˆ‘</mo><mrow><mrow><mi>ğ</mi><msub><mi>ğ”</mi><mi>ğ¢</mi></msub></mrow><mspace width="0.167em"></mspace><mo>âˆˆ</mo><mspace width="0.167em"></mspace><mi>S</mi><mi>A</mi></mrow></munder><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><msub><mi>Î¼</mi><mi>j</mi></msub><msub><mi>M</mi><mi>j</mi></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">
U = \sum_{\boldsymbol{PU_i} \, \in \,SA} -\lambda c_i + \sum_{\boldsymbol{PU_i} \, \in \,SA} \sum_{j=1}^J \mu_j f_j + \sum_{\boldsymbol{PU_i} \, \in \,SA} \sum_{j=1}^J \mu_j M_j,
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mo>âˆ‘</mo><mrow><mrow><mi>ğ</mi><msub><mi>ğ”</mi><mi>ğ¢</mi></msub></mrow><mspace width="0.167em"></mspace><mo>âˆˆ</mo><mspace width="0.167em"></mspace><mi>S</mi><mi>A</mi></mrow></munder><msub><mi>c</mi><mi>i</mi></msub><mo>â‰¤</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">
\sum_{\boldsymbol{PU_i} \, \in \, SA} c_i \leq B
</annotation></semantics></math></p>
<p>A set of planning units
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ€</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mrow><mi>ğ</mi><mi>ğ”</mi></mrow><mn>1</mn></msub><mo>,</mo><msub><mrow><mi>ğ</mi><mi>ğ”</mi></mrow><mn>2</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mrow><mi>ğ</mi><msub><mi>ğ”</mi><mi>ğ¢</mi></msub></mrow><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mrow><mi>ğ</mi><msub><mi>ğ”</mi><mi>ğ¢</mi></msub></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{A}=(\boldsymbol{PU}_1, \boldsymbol{PU}_2, ..., \boldsymbol{PU_i}, ..., \boldsymbol{PU_i})</annotation></semantics></math>
is considered to be protected when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>ğ</mi><msub><mi>ğ”</mi><mi>ğ¢</mi></msub></mrow><mspace width="0.167em"></mspace><mo>âˆˆ</mo><mspace width="0.167em"></mspace><mi>S</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{PU_i} \, \in \, SA</annotation></semantics></math>.
The protection of any
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ</mi><msub><mi>ğ”</mi><mi>ğ¢</mi></msub></mrow><annotation encoding="application/x-tex">\boldsymbol{PU_i}</annotation></semantics></math>
results in a cost
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>i</mi></msub><annotation encoding="application/x-tex">c_i</annotation></semantics></math>.
A finite set of features
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ…</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>F</mi><mn>1</mn></msub><mo>,</mo><msub><mi>F</mi><mn>2</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>F</mi><mi>j</mi></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>F</mi><mi>J</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{F}=(F_1, F_2, ... , F_j, ..., F_J)</annotation></semantics></math>
is also distributed in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>,
suggesting that these features can be spatially mapped within the PUs.
Each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>U</mi></mrow><annotation encoding="application/x-tex">PU</annotation></semantics></math>
is thus defined as a spatial object containing the following properties:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>ğ</mi><msub><mi>ğ”</mi><mi>ğ¢</mi></msub></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>f</mi><mn>1</mn></msub><mo>,</mo><msub><mi>f</mi><mn>2</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>f</mi><mi>j</mi></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>f</mi><mi>J</mi></msub><mo>,</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{PU_i}=(f_1, f_2, ..., f_j, ..., f_J, c_i)</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mi>j</mi></msub><annotation encoding="application/x-tex">f_j</annotation></semantics></math>
indicates the quantity of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mi>j</mi></msub><annotation encoding="application/x-tex">F_j</annotation></semantics></math>
located in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msub><mi>U</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">PU_i</annotation></semantics></math>.
We use the annotation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>M</mi><mi>j</mi></msub><annotation encoding="application/x-tex">M_j</annotation></semantics></math>
for the values of the metric for every feature
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>.
By inserting metrics into the analysis, each PUâ€™s
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ</mi><msub><mi>ğ”</mi><mi>ğ¢</mi></msub></mrow><annotation encoding="application/x-tex">\boldsymbol{PU_i}</annotation></semantics></math>)
properties are extended and can be expressed as follows:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>ğ</mi><msub><mi>ğ”</mi><mi>ğ¢</mi></msub></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>f</mi><mn>1</mn></msub><mo>,</mo><msub><mi>f</mi><mn>2</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>f</mi><mi>j</mi></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>f</mi><mi>J</mi></msub><mo>,</mo><msub><mi>M</mi><mn>1</mn></msub><mo>,</mo><msub><mi>M</mi><mn>2</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>M</mi><mi>j</mi></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>M</mi><mi>J</mi></msub><mo>,</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{PU_i} = (f_1, f_2, ..., f_j, ..., f_J, M_1, M_2, ..., M_j, ..., M_J, c_i)</annotation></semantics></math>.</p>
<p>The first input that can be given to the algorithm is a typical cost
layer representing the cost of protecting each single planning unit.
This cost layer is inserted to <strong>prioritizr</strong>. If such a
cost layer is not available, a cost layer with all planning units having
equal cost can be inserted (Fig. <a href="#ref-Costraster">5</a>. The
algorithm needs a cost layer, in order to determine the planning
units.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set tmap to â€œviewâ€ mode</span></span>
<span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tmap_mode.html" class="external-link">tmap_mode</a></span><span class="op">(</span><span class="st">"view"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read the cost raster</span></span>
<span><span class="va">cost_raster</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_cost_raster.html">get_cost_raster</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the cost raster with tmap</span></span>
<span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">cost_raster</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_raster.html" class="external-link">tm_raster</a></span><span class="op">(</span>col.legend <span class="op">=</span> <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_legend.html" class="external-link">tm_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"cost"</span>,</span>
<span>            position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"right"</span>, <span class="st">"top"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## The visual variable "col" of the layer "raster" contains a unique value. Therefore a discrete scale is applied (tm_scale_discrete).</span></span></code></pre>
<p align="center">
<img src="cost_raster.png" alt="Cost raster" width="50%"></p>
<p class="caption" align="center">
<span id="ref-Costraster"></span>Fig. 5: Cost raster
</p>
<p>The second input are the features rasters. In case such rasters are
not available, a raster with equal values can be given to the algorithm.
In this case we have used such a pseudo-raster, adding some noise to
improve the performance of the algorithm.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read the features raster</span></span>
<span><span class="va">features</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_features_raster.html">get_features_raster</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the features raster with tmap</span></span>
<span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">features</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_raster.html" class="external-link">tm_raster</a></span><span class="op">(</span>col.legend <span class="op">=</span> <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_legend.html" class="external-link">tm_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"f1"</span>,</span>
<span>            position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"right"</span>, <span class="st">"top"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p align="center">
<img src="features.png" alt="Features raster" width="50%"></p>
<p class="caption" align="center">
<span id="ref-Features"></span>Fig. 6: Features raster
</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Solve an ordinary prioritizr prioritization problem</span></span>
<span><span class="va">basic_solution</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basic_scenario.html">basic_scenario</a></span><span class="op">(</span></span>
<span>                    cost_raster <span class="op">=</span> <span class="va">cost_raster</span>,</span>
<span>                    features    <span class="op">=</span> <span class="va">features</span>,</span>
<span>                    budget_perc <span class="op">=</span> <span class="fl">0.1</span></span>
<span>                  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Solve a prioritizr prioritization problem,</span></span>
<span><span class="co"># by incorporating graph connectivity of the features</span></span>
<span><span class="va">connectivity_solution</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/connectivity_scenario.html">connectivity_scenario</a></span><span class="op">(</span></span>
<span>                           cost_raster <span class="op">=</span> <span class="va">cost_raster</span>,</span>
<span>                           features    <span class="op">=</span> <span class="va">features</span>,</span>
<span>                           budget_perc <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                           pre_graphs  <span class="op">=</span> <span class="va">pre_graphs</span></span>
<span>                         <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="step-4-post-processing">Step 4: Post-processing:<a class="anchor" aria-label="anchor" href="#step-4-post-processing"></a>
</h4>
<p>The results obtained from <strong>prioritizr</strong> are presented
using matrices and plots, allowing the user to compare the outcomes of
incorporating connectivity metrics in the analysis. Function
<code><a href="../reference/get_outputs.html">get_outputs()</a></code> takes as input a prioritization solution. The
user can also get the outputs as shapefiles and raster to use them in
their analysis.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co"># Get outputs from basic_scenario function for feature â€œf1â€</span></span>
<span><span class="va">basic_outputs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_outputs.html">get_outputs</a></span><span class="op">(</span>solution   <span class="op">=</span> <span class="va">basic_solution</span>, </span>
<span>                             feature    <span class="op">=</span> <span class="st">"f1"</span>,</span>
<span>                             pre_graphs <span class="op">=</span> <span class="va">pre_graphs</span><span class="op">)</span></span>
<span><span class="va">basic_outputs</span><span class="op">$</span><span class="va">tmap</span></span></code></pre></div>
<pre><code>The visual variable "col" of the layer "lines" contains a unique value. Therefore a discrete scale is applied (tm_scale_discrete).</code></pre>
<p align="center">
<img src="basic_output.png" alt="Basic solution with connections shown" width="50%"></p>
<p class="caption" align="center">
<span id="ref-Basic"></span>Fig. 7: Basic solution with connections
shown
</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Print summary of features and connections held</span></span>
<span><span class="co"># percentages for basic scenario</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">basic_outputs</span><span class="op">$</span><span class="va">connectivity_table</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##  feature relative_held connections(%)</span></span>
<span><span class="co">## 1     f1      0.178563              0</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get outputs from connectivity_scenario function for feature â€œf1â€</span></span>
<span><span class="va">connectivity_outputs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_outputs.html">get_outputs</a></span><span class="op">(</span>solution   <span class="op">=</span> <span class="va">connectivity_solution</span>,</span>
<span>                                    feature    <span class="op">=</span> <span class="st">"f1"</span>,</span>
<span>                                    pre_graphs <span class="op">=</span> <span class="va">pre_graphs</span><span class="op">)</span></span>
<span><span class="va">connectivity_outputs</span><span class="op">$</span><span class="va">tmap</span></span></code></pre></div>
<p align="center">
<img src="connectivity_output.png" alt="Connectivity solution with connections shown" width="50%"></p>
<p class="caption" align="center">
<span id="ref-Connectivity"></span>Fig. 8: Connectivity solution with
connections shown
</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Print summary of features and connections held percentages</span></span>
<span><span class="co"># for connectivity scenario</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">connectivity_outputs</span><span class="op">$</span><span class="va">connectivity_table</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##  feature relative_held connections(%)</span></span>
<span><span class="co">## 1     f1     0.1637209      0.3339886</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="graph-connectivity-rasters">Graph Connectivity Rasters:<a class="anchor" aria-label="anchor" href="#graph-connectivity-rasters"></a>
</h4>
<p>Accessing and working directly with the graph connectivity rasters
used as features in the <code>connectivity_scenario</code> function is
possible by two ways. The first way is after running
<code>connectivity_scenario</code>, retrieving its output elements named
<code>original_connectivity_rast</code>/<code>normalized_connectivity_rast</code>.
The second one is computing these rasters directly from
<code>get_metrics</code> output and a planning units SpatRaster object
(<code>pu_raster</code>).</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define planning units area SpatRaster, matching the coordinates of pre_graphs</span></span>
<span><span class="va">pu_raster</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_cost_raster.html">get_cost_raster</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Graph connectivity SpatRaster object. pre_graphs is calculated as before.</span></span>
<span><span class="co"># It has same values with connectivity_solution$original_connectivity_rast</span></span>
<span><span class="va">f1_s_core</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graph_connectivity_rasters.html">graph_connectivity_rasters</a></span><span class="op">(</span><span class="va">pu_raster</span>, <span class="va">pre_graphs</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the graph connectivity SpatRaster with tmap.</span></span>
<span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">f1_s_core</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_raster.html" class="external-link">tm_raster</a></span><span class="op">(</span>col.legend <span class="op">=</span> <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_legend.html" class="external-link">tm_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"f1 S-core"</span>,</span>
<span>            position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"right"</span>, <span class="st">"top"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p align="center">
<img src="original_connectivity.png" alt="Graph connectivity" width="50%"></p>
<p class="caption" align="center">
<span id="ref-Connectivity"></span>Fig. 9: Graph connectivity
</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot normalized graph connectivity SpatRaster with tmap in [0,1] scale.</span></span>
<span><span class="co"># It has same values with connectivity_solution$normalized_connectivity_rast.</span></span>
<span></span>
<span><span class="va">max_</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/global.html" class="external-link">global</a></span><span class="op">(</span><span class="va">f1_s_core</span>, <span class="va">max</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">min_</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/global.html" class="external-link">global</a></span><span class="op">(</span><span class="va">f1_s_core</span>, <span class="va">min</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">f1_s_core_normalized</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">f1_s_core</span> <span class="op">-</span> <span class="va">min_</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">max_</span> <span class="op">-</span> <span class="va">min_</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">f1_s_core_normalized</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_raster.html" class="external-link">tm_raster</a></span><span class="op">(</span>col.legend <span class="op">=</span> <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_legend.html" class="external-link">tm_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Normalized f1 S-core"</span>,</span>
<span>            position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"right"</span>, <span class="st">"top"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p align="center">
<img src="normalized_connectivity.png" alt="Normalized graph connectivity" width="50%"></p>
<p class="caption" align="center">
<span id="ref-Connectivity"></span>Fig. 10: Normalized graph
connectivity
</p>
</div>
</div>
<div class="section level3">
<h3 id="references">
<strong>References</strong><a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p>CsÃ¡rdi, GÃ¡bor, and TamÃ¡s Nepusz. 2006. â€œ<span id="ref-csardi2006igraph" class="nocase">The igraph software package for
complex network research</span>.â€ <em>InterJournal</em> Complex Systems:
1695. <a href="https://igraph.org" class="external-link">https://igraph.org</a></p>
<p><span id="ref-igraph" class="nocase"></span> CsÃ¡rdi, GÃ¡bor, TamÃ¡s
Nepusz, Vincent Traag, Szabolcs HorvÃ¡t, Fabio Zanini, Daniel Noom, and
Kirill MÃ¼ller. 2024. <em>igraph: Network Analysis and Visualization in
R</em>. <a href="https://doi.org/10.5281/zenodo.7682609" class="external-link">https://doi.org/10.5281/zenodo.7682609</a></p>
<p><span id="ref-daigle2020operationalizing" class="nocase"></span>
Daigle, RÃ©mi M., Anna Metaxas, Arieanna C. Balbar, Jennifer McGowan,
Eric A. Treml, Caitlin D. Kuempel, Hugh P. Possingham, and Maria Beger.
2020. â€œOperationalizing ecological connectivity in spatial conservation
planning with Marxan Connect.â€ <em>Methods in Ecology and Evolution</em>
11 (4): 570â€“79. <a href="https://doi.org/10.1111/2041-210X.13349" class="external-link uri">https://doi.org/10.1111/2041-210X.13349</a></p>
<p><span id="ref-prioritizr" class="nocase"></span> Hanson, Jeffrey O,
Richard Schuster, Nina Morrell, Matthew Strimas-Mackey, Brandon P M
Edwards, Matthew E Watts, Peter Arcese, Joseph R Bennett, and Hugh P
Possingham. 2024. <b>prioritizr: Systematic Conservation Prioritization
in R</b>. <a href="https://CRAN.R-project.org/package=prioritizr" class="external-link">https://CRAN.R-project.org/package=prioritizr</a></p>
<p><span id="ref-hanson2025" class="nocase"></span> Hanson JO, Schuster
R, Strimasâ€Mackey M, Morrell N, Edwards BPM, Arcese P, Bennett JR, and
Possingham HP. 2025. Systematic conservation prioritization with the
prioritizr R package. <em>Conservation Biology</em>, 39: e14376. <a href="https://doi.org/10.1111/cobi.14376" class="external-link uri">https://doi.org/10.1111/cobi.14376</a></p>
<p><span id="ref-brainGraph" class="nocase"></span> Watson, Christopher
G. 2024. <b>brainGraph: Graph Theory Analysis of Brain MRI Data</b>. <a href="https://doi.org/10.32614/CRAN.package.brainGraph" class="external-link">https://doi.org/10.32614/CRAN.package.brainGraph</a></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christos Adam, Aggeliki Doxa, Nikolaos Nagkoulis, Maria Papazekou, Antonios D. Mazaris, Stelios Katsanevakis.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
